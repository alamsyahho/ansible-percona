[mysql]

# CLIENT #
port                           = {{ mysql_port }}
socket                         = {{ mysql_socket }}

[mysqld]

# GENERAL #
user                           = mysql
default_storage_engine         = InnoDB
socket                         = {{ mysql_socket }}
pid-file                       = {{ mysql_pid }}

# MyISAM #
key_buffer_size                = {{ myisam_buffer_size }}
myisam_recover                 = FORCE,BACKUP

# SAFETY #
max_allowed_packet             = 16M
max_connect_errors             = 1000000
skip_name_resolve              = 1
sysdate_is_now                 = 1
innodb_strict_mode             = 1
sql_mode                       = ALLOW_INVALID_DATES

# DATA STORAGE #
datadir                        = {{ mysql_datadir }}

# BINARY LOGGING #
log_bin                        = mysql-bin
log_bin_trust_function_creators= 1
expire_logs_days               = {{ mysql_expire_logs_days }}
sync_binlog                    = 1

# REPLICATION #
server-id                      = {{ mysql_server_id }}
read_only                      = {{ mysql_read_only }}
skip_slave_start               = {{ mysql_skip_slave_start }}
relay_log                      = /var/lib/mysql/relay-bin
slave_net_timeout              = 60
#slave-skip-errors             = 1062

# CACHES AND LIMITS #
tmp_table_size                 = 32M
max_heap_table_size            = 32M
query_cache_type               = 1
query_cache_size               = 128M
query_cache_limit              = 2M
query_cache_strip_comments     = 1
max_connections                = {{ mysql_max_connections }}
thread_cache_size              = 100
open_files_limit               = 65535
table_definition_cache         = 1024
table_open_cache               = 2048
join_buffer_size               = 128K
wait_timeout                   = 60
interactive_timeout            = 60
max_allowed_packet             = 256M

# INNODB #
innodb_flush_method            = O_DIRECT
innodb_log_files_in_group      = 2
innodb_log_file_size           = 1G
innodb_flush_log_at_trx_commit = 0
innodb_file_per_table          = 1
innodb_buffer_pool_size        = {{ mysql_innodb_buffer_size }}
innodb_buffer_pool_instances   = {{ mysql_innodb_buffer_pool_instances }}
innodb_write_io_threads        = 16
innodb_log_buffer_size         = {{ mysql_innodb_log_buffer_size }}
innodb_lock_wait_timeout       = {{ mysql_innodb_lock_wait_timeout }}

# LOGGING #
log_error                      = {{ mysql_log_error }}
log_queries_not_using_indexes  = 0
slow_query_log                 = {{ mysql_slow_query_log }}
slow_query_log_file            = {{ mysql_slow_query_log_file }}
long_query_time                = {{ mysql_long_query_time }}

# CHARACTER SET #
character_set_server           = utf8
collation-server               = utf8_general_ci

tmpdir                         = {{ mysql_tmpdir }}
group_concat_max_len           = 16M
